{"version":3,"sources":["common/storage.ts","store/state.ts","common/container.tsx","store/toast.ts","pages/home.tsx","common/data-provider.ts","store/rtc-client.ts","common/helper.ts","common/moderator-provider.tsx","common/video-player.tsx","common/media-container.tsx","pages/meeting.tsx","common/loading.tsx","common/toast.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["customStorage","storage","this","window","sessionStorage","key","JSON","parse","getItem","err","obj","objStr","stringify","setItem","token","process","REACT_APP_AGORA_APP_TOKEN","defaultState","loading","uid","peerUid","rid","roomName","resolution","mode","codec","toast","List","read","store","subject","state","Subject","commit","next","setState","initialize","subscribe","unsubscribe","message","push","variant","name","ContainerContext","React","createContext","useContainerContext","useContext","ContainerProvider","children","useState","unmounted","useRef","useEffect","current","write","value","Provider","defaultToastState","useStylesA","makeStyles","theme","fontStyle","color","midItem","marginTop","marginBottom","item","flex","display","alignItems","coverLeft","background","flexDirection","coverContent","justifyContent","container","card","minWidth","minHeight","maxHeight","borderRadius","boxShadow","input","maxWidth","alignSelf","grid","margin","button","lineHeight","fontSize","textTransform","height","width","backgroundColor","spacing","radio","padding","paddingRight","useInputStyles","formInput","borderBottom","IndexCard","classes","history","useHistory","inputClasses","Box","FormControl","className","clsx","InputLabel","htmlFor","Input","id","onChange","evt","target","match","updateRoom","Button","onClick","e","preventDefault","updateUid","Date","now","pathname","addMessage","useStylesB","coverRight","position","Facade","Card","textAlign","fontWeight","useStyles","boxSizing","memo","stopLoading","Container","safeParse","str","console","warn","dataProvider","resp","socket","sessionId","cname","peer_uid","interval","fetch","method","headers","body","eventType","callbackParam","pushFile","rawResp","json","data","resultCode","_","get","msg","wsAddress","params","startJob","reason","WebSocket","onopen","send","emit","onclose","onmessage","toString","onerror","close","EventEmitter","ConnectState","PASSWD","MD5","toLowerCase","imgByteLength","ctx","document","querySelector","getContext","getImageData","byteLength","defaultModeratorData","items","Map","ModeratorContext","ModeratorContainer","moderatorData","updateModeratorData","on","errorMsg","results","object","split","porn","sexy","neutral","scene","suggestion","type","time","filename","domId","a","async","res","blob","arrayBuffer","uint8","Uint8Array","Uint8ClampedArray","y","x","idxRGB","idx","idxRGBA","pngBuffer","encodePNG","buffer","Promise","resolve","reject","reader","FileReader","onload","result","currentTarget","img","getElementById","src","complete","readAsDataURL","Blob","downloadFetch","set","log","removeAllListeners","stream","streamID","profile","local","ref","resume","autoplay","updateAutoplay","score","updateScore","_data","isPlaying","play","fit","errState","status","stop","AnalyzeDate","useCallback","moment","tz","format","guess","getScale","n","Math","floor","DetailsView","ClientEvents","defaultMediaState","init","join","publish","connectState","DISCONNECTED","localStream","remoteStreams","webClient","client","events","AgoraRTC","createClient","event","off","removeRemote","getId","addRemoteStreams","audio","video","addLocal","subscribeClientEvents","unsubscribeClientEvents","leave","createStream","microphoneId","cameraId","mirror","setTimeout","remoteAllStreams","createLocalStream","unpublish","remoteStream","delete","removeLocal","forEach","MediaContext","MediaContainer","mediaState","setMediaState","stopBroadcasting","then","catch","useStyle","confirmBtn","marginLeft","stopBtn","border","leaveBtn","Meeting","updateStatus","passwd","updatePasswd","localStorage","encryptedPass","updateEncryptedPass","validator","updateValidator","intervalValue","updateIntervalValue","showLoading","all","startBroadcasting","connect","finally","disconnect","handleClick","_pwd","LocalPlayer","ServerPlayer","href","style","placeholder","min","defaultValue","disabled","progress","top","left","opacity","zIndex","LoadingCycle","CircularProgress","Loading","useMemo","CustomSnackbar","duration","useToastContainer","queueRef","messages","setMessages","timerRef","length","shift","map","ToastContext","args","App","path","component","Home","exact","Boolean","location","hostname","ReactDOM","render","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.c7612b72.chunk.js","sourcesContent":["class CustomStorage {\n\n  public readonly storage: Storage;\n\n  constructor() {\n    this.storage = window.sessionStorage;\n  }\n\n  read(key: string): any | null {\n    try {\n      return JSON.parse(this.storage.getItem(key) as string);\n    } catch(err) {\n      return {};\n    }\n  }\n\n  write(key: string, obj: any) {\n    const objStr = JSON.stringify(obj);\n    this.storage.setItem(key, objStr);\n  }\n}\n\nexport const customStorage = new CustomStorage();","import { customStorage } from './../common/storage';\nimport {Subject} from 'rxjs';\nimport {Map, List} from 'immutable';\nimport MD5 from 'js-md5';\n\nconst token = process.env.REACT_APP_AGORA_APP_TOKEN as string;\n\nexport interface IState {\n  loading: boolean\n  uid: number\n  peerUid: number\n  rid: string\n  roomName: string\n  token: string\n  resolution: string\n  mode: string\n  codec: string\n  toast: List<{variant: string, message: string}>\n}\n\nexport const defaultState: IState = {\n  loading: false,\n  uid: 0,\n  peerUid: 0,\n  rid: '',\n  roomName: '',\n  token,\n  resolution: '480p',\n  mode: 'live',\n  codec: 'h264',\n  toast: List(),\n  ...customStorage.read('user'),\n};\n\nclass State implements StateProtocol<IState> {\n  public subject: Subject<IState> | null;\n  public state: IState = defaultState;\n  constructor() {\n    this.subject = null;\n  }\n\n  initialize () {\n    this.subject = new Subject<IState>();\n    this.commit(this.state);\n  }\n\n  commit(state: IState) {\n    this.subject && this.subject.next(state);\n  }\n\n  subscribe (setState: any) {\n    this.initialize();\n    this.subject && this.subject.subscribe(setState);\n  }\n\n  unsubscribe() {\n    this.subject && this.subject.unsubscribe();\n  }\n\n  showLoading() {\n    this.state = {\n      ...this.state,\n      loading: true\n    }\n    this.commit(this.state);\n  }\n\n  stopLoading() {\n    this.state = {\n      ...this.state,\n      loading: false\n    }\n    this.commit(this.state);\n  }\n  \n  toastError(message: string) {\n    this.state = {\n      ...this.state,\n      toast: this.state.toast.push(\n        {variant: 'error', message}\n      ),\n    }\n    this.commit(this.state);\n  }\n\n  toastInfo(message: string) {\n    this.state = {\n      ...this.state,\n      toast: this.state.toast.push(\n        {variant: 'info', message}\n      ),\n    }\n    this.commit(this.state);\n  }\n\n  toastSuccess(message: string) {\n    this.state = {\n      ...this.state,\n      toast: this.state.toast.push(\n        {variant: 'success', message}\n      ),\n    }\n    this.commit(this.state);\n  }\n\n  updateRoom(name: string) {\n    this.state = {\n      ...this.state,\n      roomName: name\n    }\n    this.commit(this.state);\n  }\n\n  clear() {\n    this.state = defaultState;\n    this.commit(this.state);\n  }\n\n  updateUid(uid: number) {\n    this.state ={\n      ...this.state,\n      uid,\n      peerUid: uid+1,\n    }\n    this.commit(this.state);\n  }\n}\n\nexport const store = new State();","import React from 'react';\nimport { IState, defaultState, store } from '../store/state';\nimport { customStorage } from './storage';\n\nexport const ContainerContext = React.createContext({} as IState);\n\nexport const useContainerContext = () => React.useContext(ContainerContext);\n\nexport const ContainerProvider: React.FC<{}> = ({children}) => {\n\n  const [state, setState] = React.useState<IState>(defaultState);\n\n  const unmounted = React.useRef<boolean>(false);\n\n  React.useEffect(() => {\n    store.subscribe((state: IState) => {\n      !unmounted.current && setState(state);\n    });\n    return () => {\n      unmounted.current = true;\n      store.unsubscribe();\n    }\n  }, []);\n\n  React.useEffect(() => {\n    customStorage.write('user', {\n      uid: state.uid,\n      peerUid: state.peerUid,\n      roomName: state.roomName\n    })\n  }, [state.uid, state.peerUid, state.roomName]);\n\n  //@ts-ignore\n  window.state = state;\n\n  const value = state;\n\n  return (\n    <ContainerContext.Provider value={value}>\n      {children}\n    </ContainerContext.Provider>\n  )\n}","import { Subject } from 'rxjs';\n\nexport interface IToastState {\n  message: string\n}\n\nexport const defaultToastState = {\n  message: ''\n}\n\nexport class Toast implements StateProtocol<IToastState> {\n\n  public subject: Subject<IToastState> | null;\n  public state: IToastState;\n\n  constructor() {\n    this.state = defaultToastState;\n    this.subject = null;\n  }\n\n  initialize() {\n    this.state = defaultToastState;\n    this.subject = new Subject<IToastState>();\n    this.subject.next(this.state);\n  }\n\n  commit(state: IToastState) {\n    this.subject && this.subject.next(state);\n  }\n\n  subscribe(setState: any) {\n    this.initialize();\n    this.subject && this.subject.subscribe(setState);\n  }\n\n  unsubscribe() {\n    this.subject && this.subject.unsubscribe();\n    this.subject = null;\n  }\n\n  addMessage(message: string) {\n    this.state = {\n      ...this.state,\n      message,\n    }\n    this.commit(this.state);\n  }\n}\n\nexport const toast = new Toast();\n//@ts-ignore\nwindow.toast = toast","import React, { useEffect } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Box from '@material-ui/core/Box';\nimport Card from '@material-ui/core/Card';\nimport { useHistory } from 'react-router';\nimport FormControl from '@material-ui/core/FormControl';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport Input from '@material-ui/core/Input';\nimport Button from '@material-ui/core/Button';\nimport clsx from 'clsx';\nimport { useContainerContext } from '../common/container';\nimport { store } from '../store/state';\nimport { toast } from '../store/toast';\nimport Container from '@material-ui/core/Container';\nimport {encode as encodePNG, decode as decodePNG} from 'fast-png';\nimport {downloadFetch} from '../common/helper';\n\nfunction arrayBufferToBase64(buffer: ArrayBuffer) {\n  let binary = '';\n  let bytes = new Uint8Array(buffer);\n  let len = bytes.byteLength;\n  for (let i = 0; i < len; i++) {\n      binary += String.fromCharCode(bytes[i]);\n  }\n  return window.btoa(binary);\n}\n\nconst useStylesA = makeStyles(theme => ({\n  fontStyle: {\n    color: '#9ee2ff',\n  },\n  midItem: {\n    marginTop: '1rem',\n    marginBottom: '6rem',\n  },\n  item: {\n    flex: 1,\n    display: 'flex',\n    alignItems: 'center'\n  },\n  coverLeft: {\n    background: `linear-gradient(to bottom, #307AFF, 50%, #46cdff)`,\n    alignItems: 'center',\n    flex: 1,\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  coverContent: {\n    display: 'flex',\n    justifyContent: 'center',\n    flexDirection: 'column',\n    color: '#fff',\n  },\n  container: {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  card: {\n    display: 'flex',\n    minWidth: 700,\n    minHeight: 500,\n    maxHeight: 500,\n    borderRadius: '10px',\n    boxShadow: '0px 6px 18px 0px rgba(0,0,0,0.2)'\n  },\n  input: {\n    maxWidth: '250px',\n    minWidth: '250px',\n    alignSelf: 'center',\n  },\n  grid: {\n    margin: '0 !important',\n  },\n  button: {\n    lineHeight: '21px',\n    color:'rgba(255,255,255,1)',\n    fontSize: '17px',\n    textTransform: 'none',\n    height: '44px',\n    width: '260px',\n    '&:hover': {\n      backgroundColor: '#82C2FF',\n    },\n    margin: theme.spacing(1),\n    marginTop: '33px',\n    backgroundColor: '#44a2fc',\n    borderRadius: '30px'\n  },\n  radio: {\n    padding: '0',\n    fontSize: '14px',\n    // display: 'flex',\n    alignItems: 'center',\n    paddingRight: '5px',\n  }\n}));\n\n\nconst useInputStyles = makeStyles(theme => ({\n  formInput: {\n    '&:after': {\n      borderBottom: '1px solid #44a2fc'\n    }\n  }\n}));\n\n\nfunction IndexCard () {\n  const classes = useStylesA();\n  const history = useHistory();\n  const state = useContainerContext();\n\n  const inputClasses = useInputStyles();\n\n  const handleClick = (e: any) => {\n    e.preventDefault();\n    if (!state.roomName) {\n      toast.addMessage(`Your need enter the topic`);\n      return;\n    }\n    store.updateUid(+Date.now() % 1000000);\n    history.push({pathname: `/meeting/${state.roomName}`});\n  }\n\n  return (\n    <Box flex=\"1\" display=\"flex\" alignItems=\"center\" justifyContent=\"flex-start\" flexDirection=\"column\">\n      <Box marginTop=\"92\" flex=\"1\" display=\"flex\" alignItems=\"center\" justifyContent=\"center\" flexDirection=\"column\">\n        <FormControl className={clsx(classes.input, classes.grid)}>\n          <InputLabel htmlFor=\"channelName\">Pick a topic to chat</InputLabel>\n          <Input\n            className={inputClasses.formInput}\n            id=\"channelName\"\n            name=\"channelName\"\n            value={state.roomName}\n            onChange={(evt: any) => {\n              const input = evt.target.value.match(/^[a-zA-Z0-9]*/)[0];\n              store.updateRoom(input ? input : '');\n            }}\n          />\n          {/* <img src=\"https://agora-adc-artifacts.oss-cn-beijing.aliyuncs.com/moderator/0fc91fbedb40c7f2f2d26ba349569696_model__uid_s_4090926300__uid_e_video_20191226035500353.rgb\" alt=\"xx\"\n            onLoad={(evt: any) => {\n              console.log(\"onLoad evt \", evt)\n            }}\n            onError={(evt: any) => {\n              console.log(\"onError error \", evt)\n            }}\n          /> */}\n\n        </FormControl>\n        <FormControl className={classes.grid}>\n          <Button onClick={handleClick} variant=\"contained\" color=\"primary\" className={classes.button}>\n            Start Live Broadcast\n          </Button>\n        </FormControl>\n      </Box>\n    </Box>\n  )\n}\n\n\nconst useStylesB = makeStyles(theme => ({\n  fontStyle: {\n    color: '#9ee2ff',\n  },\n  midItem: {\n    fontSize: '28px',\n    marginTop: '1rem',\n    marginBottom: '6rem',\n  },\n  item: {\n    flex: 1,\n    display: 'flex',\n    alignItems: 'center'\n  },\n  coverLeft: {\n    background: `linear-gradient(to bottom, #307AFF, 50%, #46cdff)`,\n    alignItems: 'center',\n    flex: 1,\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  coverContent: {\n    display: 'flex',\n    justifyContent: 'center',\n    flexDirection: 'column',\n    color: '#fff',\n  },\n  coverRight: {\n    position: 'relative',\n    flex: 1,\n    display: 'flex',\n  },\n  container: {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  card: {\n    display: 'flex',\n    minWidth: 700,\n    minHeight: 500,\n    maxHeight: 500,\n    borderRadius: '10px',\n    boxShadow: '0px 6px 18px 0px rgba(0,0,0,0.2)'\n  },\n  input: {\n    maxWidth: '250px',\n    minWidth: '250px',\n    alignSelf: 'center',\n  },\n  grid: {\n    margin: '0 !important',\n  },\n  button: {\n    height: '44px',\n    width: '260px',\n    '&:hover': {\n      backgroundColor: '#307AFF',\n    },\n    margin: theme.spacing(1),\n    marginTop: '33px',\n    backgroundColor: '#44a2fc',\n    borderRadius: '30px'\n  }\n}));\n\nconst Facade: React.FC<{}> = () => {\n\n  const classes = useStylesB();\n\n  const download = (filename: string) => {\n    const xhr = new XMLHttpRequest();\n    xhr.open('GET', filename, true);\n    xhr.responseType = 'blob';\n    xhr.onload = function (e: any) {\n      console.log('>>>>>> GET', e);\n      console.log('>>>>> response', this.response, this.response instanceof Blob);\n      //@ts-ignore\n      let objectURL = URL.createObjectURL(this.response);\n      let myImage = new Image();\n      myImage.src = objectURL;\n      document.getElementById(\"myImg\")?.appendChild(myImage);\n    }\n    xhr.send();\n  }\n\n  return (\n    <Box display=\"flex\" alignItems=\"center\" justifyContent=\"center\">\n      <Card className={classes.card}>\n        <Box display=\"flex\" flex=\"1\">\n          <div className={classes.coverLeft}>\n            <div className={classes.item}>\n              <div className='cover-image' />\n            </div>\n            <div className={classes.item}>\n              <div className={classes.coverContent}>\n                <Box textAlign=\"center\" fontSize=\"h6.fontSize\" className={classes.fontStyle}>Welcome to</Box>\n                <Box textAlign=\"center\" fontWeight=\"fontWeightRegular\" fontSize=\"h4.fontSize\" className={classes.midItem}>VIDEO MODERATION</Box>\n                <Box textAlign=\"center\" fontWeight=\"fontWeightRegular\" className={classes.fontStyle} fontSize=\"h7.fontSize\">Powered by Agora.io</Box>\n              </div>\n            </div>\n          </div>\n          <div className={classes.coverRight}>\n            <IndexCard />\n            {/* <Switch>\n              <Route exact path=\"/\" component={IndexCard}></Route>\n            </Switch> */}\n          </div>\n        </Box>\n      </Card>\n    </Box>\n  )\n}\n\nconst useStyles1 = makeStyles(theme => ({\n  fontStyle: {\n    color: '#9ee2ff',\n  },\n  midItem: {\n    marginTop: '1rem',\n    marginBottom: '6rem',\n  },\n  item: {\n    flex: 1,\n    display: 'flex',\n    alignItems: 'center'\n  },\n  coverLeft: {\n    background: `linear-gradient(to bottom, #307AFF, 50%, #46cdff)`,\n    alignItems: 'center',\n    flex: 1,\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  coverContent: {\n    display: 'flex',\n    justifyContent: 'center',\n    flexDirection: 'column',\n    color: '#fff',\n  },\n  coverRight: {\n    position: 'relative',\n    flex: 1,\n    display: 'flex',\n  },\n  container: {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  card: {\n    display: 'flex',\n    minWidth: 700,\n    minHeight: 500,\n    maxHeight: 500,\n    borderRadius: '10px',\n    boxShadow: '0px 6px 18px 0px rgba(0,0,0,0.2)'\n  },\n  input: {\n    maxWidth: '250px',\n    minWidth: '250px',\n    alignSelf: 'center',\n  },\n  grid: {\n    margin: '0 !important',\n  },\n  button: {\n    height: '44px',\n    width: '260px',\n    '&:hover': {\n      backgroundColor: '#307AFF',\n    },\n    margin: theme.spacing(1),\n    marginTop: '33px',\n    backgroundColor: '#3AB7F8',\n    borderRadius: '30px'\n  }\n}));\n\nconst useStyles = makeStyles(() => ({\n  container: {\n    height: '100%',\n    width: '100%',\n    minWidth: 800,\n    minHeight: 600,\n    boxSizing: 'content-box',\n    display: 'flex',\n    justifyContent: \"center\"\n  }\n}));\n\nexport const Home: React.FC<{}> = () => {\n\n  const state = useContainerContext();\n  const classes = useStyles();\n\n  React.useEffect(() => {\n    if (state.loading) {\n      store.stopLoading();\n    }\n  }, [state.loading]);\n\n  return (\n    <Container maxWidth=\"sm\" className={classes.container}>\n      <Facade />\n    </Container>\n  )\n}\n\nexport default React.memo(Home);","import _ from 'lodash';\nimport { EventEmitter } from 'events';\n\nconst API_SERVICE = process.env.REACT_APP_AGORA_APP_MODERATION_API_SERVICE as string;\nconst WEBSOCKET_API_SERVICE = process.env.REACT_APP_AGORA_APP_MODERATION_API_WEB_SOCKET as string;\n\nfunction safeParse (str: string): any {\n  try {\n    const res =JSON.parse(str);\n    return res;\n  } catch(err) {\n    console.warn(err);\n    return;\n  }\n}\n\nexport interface ConnectParams {\n  uid: number\n  cname: string\n  peer_uid: number\n  interval: number\n}\n\nexport interface ModerationBody {\n  resultCode: number\n  msg: string\n  sessionId: string\n  wsAddress: string\n}\n\nclass DataProvider extends EventEmitter {\n\n  public resp: any;\n  public socket: WebSocket | null;\n  public sessionId: string;\n\n  constructor() {\n    super();\n    this.resp = {};\n    this.socket = null;\n    this.sessionId = '';\n  }\n\n  async startJob({\n    uid,\n    cname,\n    peer_uid,\n    interval\n  }: ConnectParams): Promise<ModerationBody> {\n    const rawResp = await fetch(`${API_SERVICE}/moderation`, {\n      method: \"POST\",\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        eventType: 'start',\n        callbackParam: {},\n        pushFile: 1,\n        uid: `${peer_uid}`,\n        cname,\n        // peer_uid: `${peer_uid}`,\n        interval,\n      })\n    })\n\n    let data = await rawResp.json();\n    const body: ModerationBody = {\n      resultCode: _.get(data, 'resultCode', null),\n      msg: _.get(data, 'msg'),\n      sessionId: _.get(data, 'sessionId'),\n      wsAddress: _.get(data, 'wsAddress'),\n    };\n    return body;\n  }\n\n  async connect(params: ConnectParams) {\n    let json = await this.startJob(params);\n    if (json.resultCode !== 0) {\n      throw {\n        reason: 'enable moderation failed'\n      }\n    }\n\n    this.socket = new WebSocket(`${WEBSOCKET_API_SERVICE}`);\n    this.socket.onopen = (evt: Event) => {\n      if (this.socket) {\n        this.sessionId = json.sessionId;\n        this.socket.send(JSON.stringify({\n          sessionId: json.sessionId,\n          eventType: 'join'\n        }));\n      }\n      // setInterval(() => {\n      //   if (this.socket) {\n      //     this.socket.send(JSON.stringify({\n\n      //     }))\n      //   }\n      // }, 1000);\n      this.emit('open', evt);\n    }\n    this.socket.onclose = (evt: any) => {\n      this.emit('close', evt);\n    }\n    this.socket.onmessage = (evt: any) => {\n      let data = safeParse(evt.data.toString());\n      if (typeof data === 'string') {\n        data = safeParse(data);\n      }\n      this.emit('message', {data});\n    }\n    this.socket.onerror = (evt: any) => {\n      this.emit('error', evt);\n    }\n  }\n\n  async disconnect() {\n    if (this.socket) {\n      if (this.sessionId) {\n        this.socket.send(JSON.stringify({\n          sessionId: this.sessionId,\n          eventType: 'quit'\n        }))\n      }\n      this.socket.close();\n    }\n  }\n}\n\nexport const dataProvider = new DataProvider();\n// @ts-ignore\nwindow.data = dataProvider;","import AgoraRTC from 'agora-rtc-sdk';\nimport { EventEmitter } from 'events';\nimport {Subject} from 'rxjs';\nimport {Map} from 'immutable';\n\nexport const APP_ID = process.env.REACT_APP_AGORA_APP_ID as string;\n\ntype AgoraWebClient = AgoraRTC.Client;\n\nconst ClientEvents: any[] = [\n  \"error\",\n  \"exception\",\n  \"network-quality\",\n  \"peer-leave\",\n  \"stream-subscribed\",\n  \"stream-added\",\n  \"stream-removed\",\n  \"stream-published\",\n  \"connection-state-changed\"\n];\n\nexport enum ConnectState {\n  DISCONNECTED = 1,\n  CONNECTING = 2,\n  CONNECTED = 3\n}\n\nexport interface IMediaState {\n  init: boolean\n  join: boolean\n  publish: boolean\n  connectState: ConnectState\n  localStream: AgoraRTC.Stream | null\n  remoteStreams: Map<number, AgoraRTC.Stream>\n}\n\nexport const defaultMediaState: IMediaState = {\n  init: false,\n  join: false,\n  publish: false,\n  connectState: ConnectState.DISCONNECTED,\n  localStream: null,\n  remoteStreams: Map<number, AgoraRTC.Stream>(),\n}\n\nclass RTCClient extends EventEmitter implements StateProtocol<IMediaState> {\n\n  public readonly client: AgoraWebClient;\n  public localStream: AgoraRTC.Stream | null;\n\n  public state: IMediaState = defaultMediaState;\n  public subject: Subject<IMediaState> | null;\n  public events: any[] = [];\n\n  constructor() {\n    super();\n    this.client = AgoraRTC.createClient({\n      mode: 'rtc',\n      codec: 'h264'\n    });\n    this.subject = null;\n    this.localStream = null;\n  }\n\n  initialize() {\n    this.subject = new Subject<IMediaState>(); \n    this.subject.next(this.state);\n  }\n\n  subscribe(setState: any) {\n    try {\n      // console.log('init subscribe');\n      this.initialize();\n      this.subject && this.subject.subscribe(setState);      \n    } catch(err) {\n      console.warn(err);\n    }\n  }\n\n  unsubscribe() {\n    try {\n      this.subject && this.subject.unsubscribe();\n      this.subject = null;\n    } catch(err) {\n      console.warn(err);\n    }\n  }\n\n  commit (state: IMediaState) {\n    this.subject && this.subject.next(state);\n  }\n\n  async init () {\n    await new Promise((resolve, reject) => {\n      this.client.init(APP_ID, () => {\n        this.state = {\n          ...this.state,\n          init: true,\n        }\n        this.commit(this.state);\n        resolve();\n      }, reject);\n    })\n  }\n\n  subscribeClientEvents() {\n    for (let event of ClientEvents) {\n      this.events.push(event);\n      this.client.on(event, (evt: any) => {\n        this.emit(event, evt);\n      })\n    }\n  }\n\n  unsubscribeClientEvents() {\n    for (let event of this.events) {\n      this.client.off(event, () => {});\n    }\n    this.events = [];\n  }\n\n  async join(uid: number, cname: string) {\n    await new Promise((resolve, reject) => {\n      const webClient = this;\n      webClient.on('error', (evt: any) => {\n        console.warn('error', evt);\n      });\n      webClient.on('exception', (evt: any) => {\n        console.warn('exception', evt);\n      });\n      // webClient.on('network-quality', (evt: any) => {\n      //   console.warn('network-quality', evt);\n      // });\n      webClient.on('peer-leave', (evt: any) => {\n        webClient.removeRemote(evt.uid);\n      });\n      webClient.on('stream-subscribed', (evt: any) => {\n        const uid = evt.stream.getId();\n        webClient.addRemoteStreams(uid, evt.stream);\n      })\n      webClient.on('stream-added', (evt: any) => {\n        console.log(\" peer stream \", evt.stream.getId());\n        webClient.client.subscribe(evt.stream, {audio: true, video: true});\n      });\n      webClient.on('stream-removed', (evt: any) => {\n        webClient.removeRemote(evt.stream.getId());\n      });\n      webClient.on('stream-published', (evt: any) => {\n        console.log(\"stream published\", evt.stream);\n        webClient.addLocal(evt.stream);\n      });\n      webClient.on('connection-state-change', (evt: any) => {\n      });\n      this.subscribeClientEvents();\n      this.client.join(null, cname, uid, () => {\n        this.state = {\n          ...this.state,\n          join: true,\n        }\n        this.commit(this.state);\n        resolve()\n      }, reject);\n    })\n  }\n\n  async leave() {\n    await new Promise((resolve, reject) => {\n      this.unsubscribeClientEvents();\n      this.client.leave(() => {\n        this.state = {\n          ...this.state,\n          join: false,\n          publish: false,\n        }\n        this.commit(this.state);\n        resolve();\n      }, reject);\n    })\n  }\n\n  async createLocalStream(uid: number) {\n    const stream = AgoraRTC.createStream({\n      video: true,\n      audio: true,\n      microphoneId: '',\n      cameraId: '',\n      streamID: uid,\n      mirror: false,\n    });\n    await new Promise((resolve, reject) => {\n      stream.init(() => {\n        this.localStream = stream;\n        resolve();\n      }, reject);\n    })\n  }\n\n  async publish() {\n    await new Promise((resolve, reject) => {\n      if (this.localStream) {\n        this.client.publish(this.localStream, reject)\n        setTimeout(() => {\n          this.state = {\n            ...this.state,\n            publish: true,\n          }\n          this.commit(this.state);\n          resolve()\n        }, 300);\n      }\n      resolve();\n    });\n  }\n\n  async unpublish() {\n    this.localStream && this.localStream.close();\n    this.localStream = null;\n    this.remoteAllStreams();\n    // await new Promise((resolve, reject) => {\n    //   if (this.localStream) {\n    //     this.client.unpublish(this.localStream, reject);\n    //     setTimeout(() => {\n    //       this.state = {\n    //         ...this.state,\n    //         publish: false,\n    //       }\n    //       this.commit(this.state);\n    //       resolve()\n    //     }, 300);\n    //   }\n    //   resolve();\n    // });\n  }\n\n  async startBroadcasting(uid: number, cname: string) {\n    await this.init();\n    await this.join(uid, cname);\n    await this.createLocalStream(uid);\n    await this.publish();\n  }\n\n  async stopBroadcasting() {\n    this.removeAllListeners();\n    await this.unpublish();\n    await this.leave();\n  }\n\n\n  addLocal(stream: any) {\n    this.state = {\n      ...this.state,\n      localStream: stream\n    }\n    this.commit(this.state);\n  }\n\n  removeLocal() {\n    this.state.localStream && this.state.localStream.close();\n    this.state = {\n      ...this.state,\n      localStream: null\n    }\n    this.commit(this.state);\n  }\n\n  addRemoteStreams(uid: number, stream: any) {\n    this.state = {\n      ...this.state,\n      remoteStreams: this.state.remoteStreams.set(uid, stream)\n    }\n    this.commit(this.state);\n  }\n\n  removeRemote(uid: number) {\n    const remoteStream = this.state.remoteStreams.get(uid);\n    if (remoteStream) {\n      remoteStream.isPlaying() && remoteStream.stop();\n    }\n    this.state = {\n      ...this.state,\n      remoteStreams: this.state.remoteStreams.delete(uid)\n    }\n    this.commit(this.state);\n  }\n\n  remoteAllStreams () {\n    this.removeLocal();\n    this.state.remoteStreams.forEach((stream: AgoraRTC.Stream) => {\n      stream.isPlaying() && stream.stop();\n    });\n  }\n}\n\nexport const webClient = new RTCClient();\n\n//@ts-ignore\nwindow.webClient = webClient;","import {encode as encodePNG} from 'fast-png';\nimport MD5 from 'js-md5';\n\nlet _byteLength = 0;\n\nconst clientWidth = 299;\nconst clientHeight = 299;\n\nexport const getLocalPassword = (): string => {\n  return localStorage.getItem(\"passwd\") ? localStorage.getItem(\"passwd\") as string: '';\n}\n\nexport const PASSWD = MD5((process.env.REACT_APP_AGORA_PASSWORD as string).toLowerCase());\n\nconst imgByteLength = () => {\n  if (_byteLength > 0) return _byteLength;\n  const canvas = document.querySelector(\"canvas\") as HTMLCanvasElement;\n  const ctx = canvas.getContext('2d');\n  if (ctx) {\n    const {data} = ctx.getImageData(0, 0, clientWidth, clientHeight);\n    return data.byteLength;\n  }\n  return 0;\n}\n\nexport const downloadFetch = async (filename: string, domId: string) => {\n\n  const byteLength = imgByteLength();\n  if (!byteLength) {\n    console.warn('canvas not mounted');\n  }\n\n  const res = await fetch(filename, {\n    method: 'GET',\n    // headers: {\n    //   'Content-Type': 'application/octet-stream',\n    // }\n  });\n  const blob: Blob = await res.blob();\n  // @ts-ignore\n  const arrayBuffer = await blob.arrayBuffer();\n  const uint8 = new Uint8Array(arrayBuffer);\n\n  const data = new Uint8ClampedArray(byteLength);\n  // transform rgb24 to rgba32\n  for (let y = 0; y < clientHeight; y++) {\n    for (let x = 0; x < clientWidth; x++) {\n      const idx = y * clientWidth + x;\n      const idxRGB = idx * 3;\n      const idxRGBA = idx * 4;\n      data[idxRGBA + 0] = uint8[idxRGB + 0];\n      data[idxRGBA + 1] = uint8[idxRGB + 1];\n      data[idxRGBA + 2] = uint8[idxRGB + 2];\n      data[idxRGBA + 3] = 255;\n    }\n  }\n\n  const pngBuffer = encodePNG({\n    data: new Uint8Array(data.buffer),\n    height: clientHeight,\n    width: clientWidth\n  });\n\n  await new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onload = (e: any) => {\n      const {result} = e.currentTarget;\n      const img = document.getElementById(domId) as HTMLImageElement;\n      if (img) {\n        img.src = result;\n        img.complete && resolve(result);\n      } else {\n        console.warn('img is empty, domId: ', domId);\n        resolve();\n      }\n    }\n    reader.readAsDataURL(new Blob([pngBuffer], {type: \"image/png\"}));\n  })\n\n\n}","import React from 'react';\nimport { Map } from 'immutable';\nimport { dataProvider } from './data-provider';\nimport _ from 'lodash';\nimport { downloadFetch } from './helper';\n\nconst OSS_URL = process.env.REACT_APP_AGORA_CDN_URL as string;\n\nexport interface DataStruct {\n  uid: number\n  porn: number\n  time: number\n  sexy: number\n  neutral: number\n  object: string\n  scene: string\n  suggestion: string\n}\n\nexport interface IModeratorData {\n  items: Map<number, DataStruct>\n}\n\nconst defaultModeratorData = {\n  items: Map<number, DataStruct>(),\n}\n\nexport const ModeratorContext = React.createContext({} as IModeratorData);\n\nexport const useModerator = () => React.useContext(ModeratorContext);\n\nconst ModeratorProvider: React.FC<any> = ({children}) => {\n\n  const [moderatorData, updateModeratorData] = React.useState<IModeratorData>(defaultModeratorData);\n\n  // React.useEffect(() => {\n  //   if (!moderatorData.items.count()) return;\n  //   console.log(moderatorData.items.toJSON());\n  // }, [moderatorData]);\n\n  React.useEffect(() => {\n    dataProvider.on('open', (evt: any) => {\n      // console.log('open', evt);\n    });\n    dataProvider.on('close', (evt: any) => {\n      // console.log('close', evt);\n    });\n    dataProvider.on('message', ({data}: any) => {\n      if (data.errorMsg === 'join succeed') {\n        // console.log('join success');\n      } else if (data.errorMsg === 'quit succeed') {\n        // console.log('quit success');\n      } else if (data && data.results && data.object){\n        const object = data.object;\n        // console.log('uid', object.split('__uid_s_')[1].split('__uid_e_')[0]);\n        const cname = object.split('_')[1];\n        const uid = object.split('__uid_s_')[1].split('__uid_e_')[0];\n        const results = _.get(data, 'results.porn.outputs');\n        const porn = results.porn;\n        const sexy = results.sexy;\n        const neutral = results.neutral;\n        const scene = _.get(data, 'results.porn.scene', '') as string;\n        const suggestion = _.get(data, 'suggestion', '') as string;\n        const type = object.split('__uid_e_')[1].split('_')[0];\n        const time = object.split(`${type}_`)[1].split('.rgb')[0];\n\n        // console.log(\"message decoder: \", object);\n        downloadFetch(`${OSS_URL}/${object}`, `preview-img-${uid}`);\n\n        // console.log(\"message decoder \", cname, time, porn, sexy, uid);\n        updateModeratorData({\n          items: moderatorData.items.set((+uid as number), {\n            uid: (+uid as number),\n            porn,\n            sexy,\n            neutral,\n            scene,\n            suggestion,\n            time,\n            object,\n          })\n        })\n      }\n      // @ts-ignore\n      // window.messageEvt = data\n      // console.log('message', data, data.object, Object.keys(data));\n    });\n    dataProvider.on('error', (evt: any) => {\n      console.log('error', evt);\n    });\n    return () => {\n      dataProvider.removeAllListeners();\n    }\n  }, []);\n  return (\n    <ModeratorContext.Provider value={moderatorData}>\n      {children}\n    </ModeratorContext.Provider>\n  )\n}\n\nexport const ModeratorContainer = React.memo(ModeratorProvider);","import React, { useEffect } from 'react';\nimport moment from 'moment-timezone';\nimport { useModerator } from './moderator-provider';\nimport { dataProvider } from './data-provider';\n\ninterface VideoScoreInfo {\n  porn: number\n  time: number\n  sexy: number\n  neutral: number\n  suggestion: string\n  scene: string\n}\n\nexport interface VideoPlayerProps {\n  domId: string\n  streamID?: number\n  stream?: any\n  local?: boolean\n  result?: string\n  profile?: boolean\n}\n\nconst VideoPlayer: React.FC<VideoPlayerProps> = ({\n  domId,\n  stream,\n  streamID,\n  local,\n  profile,\n  result,\n}) => {\n\n  const ref = React.useRef<boolean>(false);\n\n  const resume = React.useRef<boolean>(false);\n  const [autoplay, updateAutoplay] = React.useState<boolean>(false);\n\n  const data = useModerator();\n\n  const handleClick = () => {\n    if (autoplay && !resume.current) {\n      stream.resume();\n      resume.current = true;\n    }\n  }\n\n  const [score, updateScore] = React.useState<VideoScoreInfo>({\n    porn: 0,\n    time: 0,\n    sexy: 0,\n    neutral: 0,\n    suggestion: '',\n    scene: '',\n  } as VideoScoreInfo);\n\n  React.useEffect(() => {\n    if (!streamID || !data.items.get(streamID)) return;\n    const _data = data.items.get(streamID);\n    if (_data) {\n      updateScore({\n        ...score,\n        time: _data.time,\n        porn: _data.porn,\n        sexy: _data.sexy,\n        neutral: _data.neutral,\n        scene: _data.scene,\n        suggestion: _data.suggestion,\n      })\n    }\n  }, [streamID, data.items]);\n\n  React.useEffect(() => {\n    if (!stream) return;\n    if (stream) {\n      if (!ref.current && !stream.isPlaying()) {\n        ref.current = true;\n        stream.play(domId, { fit: 'cover' }, (errState: any) => {\n          ref.current = false;\n          if (errState && errState.status !== 'aborted') {\n            console.warn(\"agora stream play failed \", errState);\n            !ref.current && updateAutoplay(true);\n          }\n          errState && console.warn(errState);\n        });\n        return () => {\n          stream.isPlaying() && stream.stop();\n        }\n      }\n\n    }\n  }, [stream]);\n\n  const AnalyzeDate = React.useCallback(() => {\n    if (score.time) {\n      const time = moment.tz(''+moment(score.time, 'YYYYMMDDHHmmssSSS').format(\"YYYY/MM/DD HH:mm:ss\"), moment.tz.guess()).format('YYYY/MM/DD HH:mm:ss');\n      // const time = moment(score.time, 'YYYYMMDDHHmmssSSS').format('YYYY/MM/DD HH:mm:ss') as string;\n      return (\n        <div className=\"date\">{time}</div>\n      )\n    }\n    return (\n      <div className=\"date\"></div>\n    )\n  }, [score.time]);\n\n  const getScale = (n: number) => {\n    return Math.floor(n * 10000000) / 10000000;\n  }\n\n  const DetailsView = React.useCallback(() => {\n    if (!streamID) return null;\n    const porn = typeof score.porn === 'number' ? score.porn * 100 : score.porn;\n    const sexy = typeof score.sexy === 'number' ? score.sexy * 100 : score.sexy;\n    const neutral = typeof score.neutral === 'number' ? score.neutral * 100 : score.neutral;\n\n\n    return (\n      <div className=\"content\">\n        <div className=\"detail\">\n          <div>Scene: {score.scene}</div>\n          <div>Porn ({getScale(porn)}%)</div>\n          <div>Sexy ({getScale(sexy)}%)</div>\n          <div>Neutral ({getScale(neutral)}%)</div>\n        </div>\n      </div>\n    )\n  }, [score, streamID]);\n\n  return (\n    <div className=\"item\">\n      <div className=\"player\" id={domId} onClick={handleClick}>\n      </div>\n      {profile && score.suggestion ? <div className=\"score-info\">\n        <img className=\"preview-video-frame\" id={`preview-img-${streamID}`}></img>\n        <div className=\"table\">\n          <div className=\"main-title\">\n            {score.suggestion ?\n              <>\n                <span className=\"\">Suggestion: </span>\n                <span className={`${score.suggestion} capitalize`}>{score.suggestion}</span>\n              </>\n              : null}\n          </div>\n          <AnalyzeDate />\n          <DetailsView />\n        </div>\n      </div>\n        : null}\n    </div>\n  )\n}\n\nexport default React.memo(VideoPlayer);","import React, { useReducer } from 'react';\nimport { IMediaState, webClient, defaultMediaState } from '../store/rtc-client';\n\nexport const MediaContext = React.createContext({} as IMediaState);\n\nexport const useMediaContext = () => React.useContext(MediaContext);\n\nexport const MediaContainer: React.FC<{}> = ({children}) => {\n\n  const [mediaState, setMediaState] = React.useState<IMediaState>(defaultMediaState);\n\n  const unmounted = React.useRef<boolean>(false);\n\n  React.useEffect(() => {\n    webClient.subscribe((state: IMediaState) => {\n      !unmounted.current && setMediaState(state);\n    });\n    return () => {\n      unmounted.current = true;\n      webClient.unsubscribe();\n      webClient.stopBroadcasting().then(() => {\n\n      }).catch(console.warn);\n    }\n  }, []);\n\n  React.useEffect(() => {\n  //@ts-ignore\n  window.mediaState = mediaState;\n  }, [mediaState]);\n\n\n  return (\n    <MediaContext.Provider value={mediaState}>\n      {children}\n    </MediaContext.Provider>\n  )\n}","import React, { useEffect } from 'react';\nimport './meeting.scss';\nimport Button from '@material-ui/core/Button';\nimport makeStyles from '@material-ui/core/styles/makeStyles';\nimport { useHistory } from 'react-router';\nimport VideoPlayer from '../common/video-player';\nimport { MediaContainer, useMediaContext } from '../common/media-container';\nimport { webClient } from '../store/rtc-client';\nimport { useContainerContext } from '../common/container';\nimport { store } from '../store/state';\nimport { toast } from '../store/toast';\nimport { dataProvider } from '../common/data-provider';\nimport { ModeratorContainer } from '../common/moderator-provider';\nimport { PASSWD, getLocalPassword } from '../common/helper';\nimport MD5 from 'js-md5';\n\nconst useStyle = makeStyles(theme => ({\n  confirmBtn: {\n    lineHeight: '22px',\n    color: 'rgba(255,255,255,1)',\n    fontSize: '16px',\n    textTransform: 'none',\n    height: '40px',\n    width: '120px',\n    '&:hover': {\n      backgroundColor: '#82C2FF',\n    },\n    backgroundColor: '#3AB7F8',\n    borderRadius: '2px',\n    marginLeft: '10px'\n  },\n  stopBtn: {\n    lineHeight: '22px',\n    color: '#3AB7F8',\n    fontSize: '16px',\n    textTransform: 'none',\n    height: '40px',\n    width: '120px',\n    '&:hover': {\n      backgroundColor: '#FFFFFF',\n    },\n    backgroundColor: '#FFFFFF',\n    marginLeft: '10px',\n    border: '1px solid rgba(204,204,204,1)',\n    borderRadius: '2px'\n  },\n  leaveBtn: {\n    marginTop: '37px',\n    lineHeight: '22px',\n    backgroundColor: 'rgba(255,255,255,1)',\n    color: '#3AB7F8',\n    fontSize: '16px',\n    textTransform: 'none',\n    height: '40px',\n    width: '310px',\n    '&:hover': {\n      backgroundColor: 'rgba(255,255,255,1)',\n    },\n    border: '1px solid rgba(204,204,204,1)',\n    borderRadius: '2px'\n  }\n}));\n\n\nexport const Meeting: React.FC<{}> = () => {\n\n  const history = useHistory();\n\n  const state = useContainerContext();\n  const mediaState = useMediaContext();\n\n  const ref = React.useRef<boolean>(false);\n\n  const [status, updateStatus] = React.useState<boolean>(false);\n\n  const [passwd, updatePasswd] = React.useState<string>('');\n\n  const [encryptedPass, updateEncryptedPass] = React.useState<string>(getLocalPassword());\n\n  const [validator, updateValidator] = React.useState<string>();\n\n  const [intervalValue, updateIntervalValue] = React.useState<number>(5);\n\n  const interval = React.useRef<number>(5);\n\n  React.useEffect(() => {\n    return () => {\n      ref.current = true;\n    }\n  }, []);\n\n  React.useEffect(() => {\n    if (encryptedPass) {\n      localStorage.setItem(\"passwd\", encryptedPass);\n    }\n  }, [encryptedPass]);\n\n  React.useEffect(() => {\n    if (!state.roomName || !state.uid || !state.peerUid) {\n      toast.addMessage(`Please enter the channel name first`);\n      history.push('/');\n      return;\n    }\n    if (!status) return;\n    !ref.current && store.showLoading();\n    const cname = MD5(`${Date.now()}${state.roomName}`);\n    Promise.all([\n      webClient.startBroadcasting(state.uid, cname),\n      dataProvider.connect({\n        uid: state.uid,\n        cname: cname,\n        peer_uid: state.peerUid,\n        interval: +interval.current\n      })\n    ]).then(() => {\n    }).catch(console.warn).finally(() => {\n      !ref.current && store.stopLoading();\n    })\n    return () => {\n      !ref.current && store.showLoading();\n      Promise.all([\n        webClient.stopBroadcasting(),\n        dataProvider.disconnect()\n      ]).then(() => { })\n        .catch(console.warn)\n        .finally(() => {\n          !ref.current && store.stopLoading();\n        })\n    }\n  }, [state.roomName, state.uid, state.peerUid, status]);\n\n  const classes = useStyle();\n\n  const handleClick = (type: string) => {\n    if (type === 'leave') {\n      history.push({ pathname: '/' });\n    }\n    if (type === 'start') {\n      const _pwd = passwd.toLowerCase();\n      if (encryptedPass === PASSWD) {\n        interval.current = intervalValue;\n        updateStatus(true);\n        return;\n      }\n      else if (_pwd && MD5(_pwd) === PASSWD) {\n        updateEncryptedPass(MD5(_pwd));\n        interval.current = intervalValue;\n        updateStatus(true);\n      } else {\n        updateValidator('password invalid');\n        return;\n      }\n    }\n    if (type === 'stop') {\n      updateStatus(false);\n    }\n  }\n\n  const LocalPlayer = React.useCallback(() => {\n    if (mediaState.localStream) {\n      return (\n        <VideoPlayer\n          domId={'local'}\n          local\n          profile={status}\n          streamID={mediaState.localStream.getId()}\n          stream={mediaState.localStream}\n        />\n      )\n    }\n    return (\n      <VideoPlayer profile={status} domId={'local-placeholder'} local />\n    )\n  }, [mediaState.localStream, status]);\n\n  const ServerPlayer = React.useCallback(() => {\n    // console.log(\"remoteStream\", mediaState.remoteStreams, state.peerUid);\n    const remoteStream = mediaState.remoteStreams.get(state.peerUid);\n    // console.log(\" player \", remoteStream);\n    if (remoteStream) {\n      return (<VideoPlayer\n        domId={'remote'}\n        streamID={remoteStream.getId()}\n        stream={remoteStream}\n        profile={status}\n      />)\n    }\n    return (\n      <VideoPlayer\n        domId={'remote-placeholder'}\n        profile={status}\n      />\n    )\n  }, [mediaState.remoteStreams, state.peerUid, status]);\n\n  return (\n    <div className=\"meeting-container\">\n      <div className=\"nav\">\n        {/* <a href=\"https://www.agora.io\" target=\"_blank\"> */}\n        <a className=\"agora-logo\" href=\"https://www.agora.io\" target=\"_blank\"></a>\n        {/* </a> */}\n      </div>\n      <div className=\"content-container\">\n        <div className=\"video-list\">\n          <LocalPlayer />\n          <ServerPlayer />\n        </div>\n        <div className=\"form-container\">\n          {encryptedPass !== PASSWD ? \n            <div className=\"items\">\n              <h5 className=\"field-label\" style={{\"marginBottom\": 0}}>Code</h5>\n              <span className={`validator ${validator ? '' : 'hidden'}`}>{validator}</span>\n              <input type=\"text\" name=\"pwd\" value={passwd} className=\"input\" placeholder=\"enter your passwd\" onChange={\n                (evt: any) => {\n                  updatePasswd(evt.target.value);\n                }\n              }/>\n            </div>\n          : null}\n          <div className=\"items\">\n            <h5 className=\"field-label\">Moderation Config</h5>\n            <div className=\"item\">\n              <input type=\"number\" min=\"5\" value={intervalValue} defaultValue={intervalValue} placeholder=\"interval (seconds)\" className=\"input\" disabled={status} onChange={(evt: any) => {\n                evt.preventDefault();\n                if (evt.target.value < 5) {\n                  updateIntervalValue(5);\n                } else {\n                  updateIntervalValue(evt.target.value);\n                }\n              }} />\n              {!status ? <Button onClick={() => handleClick('start')} color=\"primary\" className={classes.confirmBtn}>start</Button> :\n                <Button onClick={() => handleClick('stop')} color=\"primary\" className={classes.stopBtn}>stop</Button>\n              }\n            </div>\n          </div>\n          <div className=\"item\">\n            <Button onClick={() => handleClick('leave')} color=\"primary\" className={classes.leaveBtn}>LeaveChannel</Button>\n          </div>\n        </div>\n        {/* </form> */}\n      </div>\n    </div>\n  )\n}\n\nconst PureMeeting: React.FC<{}> = () => {\n  return (\n    <MediaContainer>\n      <ModeratorContainer>\n        <Meeting />\n      </ModeratorContainer>\n    </MediaContainer>\n  )\n}\n\nexport default React.memo(PureMeeting);","import React, { useMemo } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport {useContainerContext} from './container';\n\nconst useStyles = makeStyles(theme => ({\n  progress: {\n    margin: theme.spacing(2),\n    color: '#44A2FC'\n  },\n  container: {\n    position: 'absolute',\n    top: '0px',\n    left: '0px',\n    height: '100%',\n    width: '100%',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    background: '#ffffff',\n    opacity: 0.8,\n    zIndex: 10\n  }\n}));\n\n\nconst LoadingCycle: React.FC<{}> = () => {\n  const classes = useStyles();\n  return (\n    <div className={classes.container}>\n      <CircularProgress className={classes.progress} />\n    </div>\n  );\n}\n\nexport const Loading: React.FC<{}> = () => {\n\n  const state = useContainerContext();\n  const loading = useMemo(() => state.loading, [state.loading]);\n\n  return (\n    loading ? <LoadingCycle /> : null\n  )\n}","import React, { useEffect, useRef, useState } from 'react';\nimport './toast.scss';\nimport { IToastState, defaultToastState, toast } from '../store/toast';\n\nexport interface SnackbarMessage {\n  message: string;\n  key: number;\n}\n\ninterface SnackbarsProps {\n  duration?: number\n}\n\nfunction ConsecutiveSnackbars({\n  duration = 1500\n}: SnackbarsProps) {\n\n  const {message} = useToastContainer();\n\n  const queueRef = React.useRef<SnackbarMessage[]>([]);\n  const [messages, setMessages] = useState<SnackbarMessage[]>([]);\n  const timerRef = useRef<any>(null);\n\n  useEffect(() => {\n    if (messages.length > 0 && timerRef.current === null) {\n      timerRef.current = setTimeout(() => {\n        queueRef.current.shift()\n        toast.addMessage('');\n        setMessages([...queueRef.current]);\n        timerRef.current = null;\n      }, duration);\n    }\n  }, [messages]);\n\n\n  useEffect(() => {\n    if (queueRef.current && message) {\n      queueRef.current.push({\n        message: message,\n        key: +Date.now()\n      })\n      setMessages([...queueRef.current]);\n    }\n  }, [message]);\n\n  return (\n    <div className=\"notice-message-container\">\n      {messages.map((message: any, idx: number) => \n        <div key={`${idx}${message.key}`} className={\"custom-toast\"}>\n          <div className=\"toast-container\">\n            <span className=\"text\">{message.message}</span>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n\nconst CustomSnackbar = React.memo(ConsecutiveSnackbars);\n\nexport interface IToastProps {\n  message: string\n}\n\nexport const ToastContext = React.createContext({} as IToastProps);\n\nexport const useToastContainer = () => React.useContext(ToastContext);\n\nconst ToastContainer: React.FC<any> = ({children}) => {\n\n  const [state, setState] = React.useState<IToastState>(defaultToastState);\n\n  const unmounted = React.useRef<boolean>(false);\n\n  React.useEffect(() => {\n\n    toast.subscribe((args: any) => {\n      !unmounted.current && setState(args)\n    });\n    return () => {\n      unmounted.current = true;\n      toast.unsubscribe();\n    }\n  }, []);\n\n  const value = state;\n\n  return (\n    <ToastContext.Provider value={value}>\n      <CustomSnackbar duration={800}/>\n    </ToastContext.Provider>\n  )\n}\n\nexport default React.memo(ToastContainer);","import React from 'react';\nimport { hot } from 'react-hot-loader';\nimport './App.scss';\nimport {HashRouter as Router, Route, Switch} from 'react-router-dom';\nimport {Home, Meeting} from './pages';\nimport { ContainerProvider } from './common/container';\nimport { Loading } from './common/loading';\nimport Toast from './common/toast';\n\nconst App: React.FC = () => {\n  return (\n    <Router>\n      <Switch>\n        <ContainerProvider>\n          <Loading />\n          <Toast />\n          <Route path=\"/\" component={Home} exact></Route>\n          <Route path=\"/meeting/:name\" component={Meeting} exact></Route>\n        </ContainerProvider>\n      </Switch>\n    </Router>\n  );\n}\n\n// export default hot(module)(App);\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();"],"sourceRoot":""}